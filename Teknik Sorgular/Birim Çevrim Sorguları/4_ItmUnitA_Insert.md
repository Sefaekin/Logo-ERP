DECLARE 
	@ITEMREF int,@LINENR smallint,@UNITLINEREF int,@WIDTH float,@LENGTH float,@HEIGHT float,@AREA float,
	@VOLUME_ float,@WEIGHT float,@WIDTHREF int,@LENGTHREF int,@HEIGHTREF int,@AREAREF int,@VOLUMEREF int,@WEIGHTREF int,
	@GROSSVOLUME float,@GROSSWEIGHT float,@GROSSVOLREF int,@GROSSWGHTREF int,@CONVFACT1 float,@CONVFACT2 float
DECLARE @LOGICALREF2 INT 
DECLARE ITM_CURSOR CURSOR FOR 

SELECT I.LOGICALREF,L.LINENR,L.LOGICALREF,L.WIDTH,L.LENGTH,L.HEIGHT,L.AREA,L.VOLUME_,L.WEIGHT,L.WIDTHREF,L.LENGTHREF,
	L.HEIGHTREF,L.AREAREF,L.VOLUMEREF,L.WEIGHTREF,L.VOLUME_,L.WEIGHT,L.VOLUMEREF,L.WEIGHTREF,L.CONVFACT1,L.CONVFACT2
FROM LG_501_ITEMS I,LG_501_UNITSETL L
WHERE I.UNITSETREF=L.UNITSETREF
ORDER BY I.LOGICALREF

OPEN ITM_CURSOR
FETCH NEXT FROM ITM_CURSOR
INTO 	
	@ITEMREF ,@LINENR ,@UNITLINEREF ,@WIDTH ,@LENGTH ,@HEIGHT ,@AREA ,
	@VOLUME_ ,@WEIGHT ,@WIDTHREF ,@LENGTHREF ,@HEIGHTREF ,@AREAREF ,@VOLUMEREF ,@WEIGHTREF ,
	@GROSSVOLUME ,@GROSSWEIGHT ,@GROSSVOLREF ,@GROSSWGHTREF ,@CONVFACT1 ,@CONVFACT2 

WHILE @@FETCH_STATUS = 0
BEGIN
SELECT @LOGICALREF2=max(LOGICALREF)+1 FROM LG_501_ITMUNITA
IF @LOGICALREF2 IS NULL SELECT @LOGICALREF2=1
IF NOT EXISTS (SELECT * FROM LG_501_ITMUNITA WHERE UNITLINEREF =@UNITLINEREF AND ITEMREF=@ITEMREF AND LINENR=@LINENR) 
INSERT INTO LG_501_ITMUNITA 
(
LOGICALREF ,ITEMREF ,LINENR ,UNITLINEREF ,BARCODE ,MTRLCLAS ,PURCHCLAS ,SALESCLAS ,MTRLPRIORITY ,PURCHPRIORTY ,SALESPRIORITY ,
WIDTH ,LENGTH ,HEIGHT ,AREA ,VOLUME_ ,WEIGHT ,WIDTHREF ,LENGTHREF ,HEIGHTREF ,AREAREF ,VOLUMEREF ,WEIGHTREF ,GROSSVOLUME ,
GROSSWEIGHT ,GROSSVOLREF ,GROSSWGHTREF ,CONVFACT1 ,CONVFACT2 
) 

VALUES 
(
 @LOGICALREF2, @ITEMREF, @LINENR, @UNITLINEREF,'', 1, 1, 1, 0, 0, 0, 
 @WIDTH,@LENGTH,@HEIGHT,@AREA,@VOLUME_,@WEIGHT,@WIDTHREF,@LENGTHREF,@HEIGHTREF,@AREAREF,@VOLUMEREF,@WEIGHTREF, @GROSSVOLUME,
 @GROSSWEIGHT, @GROSSVOLREF, @GROSSWGHTREF, @CONVFACT1, @CONVFACT2 
)

FETCH NEXT FROM ITM_CURSOR
INTO 
	@ITEMREF ,@LINENR ,@UNITLINEREF ,@WIDTH ,@LENGTH ,@HEIGHT ,@AREA ,
	@VOLUME_ ,@WEIGHT ,@WIDTHREF ,@LENGTHREF ,@HEIGHTREF ,@AREAREF ,@VOLUMEREF ,@WEIGHTREF ,
	@GROSSVOLUME ,@GROSSWEIGHT ,@GROSSVOLREF ,@GROSSWGHTREF ,@CONVFACT1 ,@CONVFACT2 
END
CLOSE ITM_CURSOR
DEALLOCATE ITM_CURSOR 
GO



